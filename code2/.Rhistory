setwd("/media/johnny/C/Users/Johnny Chan/My Documents/Projects/OPNS 523/Arcidiacono-2011/code2")
source('header.R')
data<- readRDS(paste0(varSave,"engines_data.rds"))
#################################################################################################
# Global parameters. Will not be passing into functions.
#################################################################################################
s.val <- c(1,4)
beta = .99
N = 10^6
x_m <- max(data$replace_Period) + 10
CCP <- expand.grid(s=s.val, x.t=seq(0, x_m), prob.replace=.5)
theta <- c(10,1)
pi_s = .25
install.packages(c("fExtremes", "plyr", "reshape2", "dplyr", "doParallel"))
source('header.R')
data<- readRDS(paste0(varSave,"engines_data.rds"))
#################################################################################################
# Global parameters. Will not be passing into functions.
#################################################################################################
s.val <- c(1,4)
beta = .99
N = 10^6
x_m <- max(data$replace_Period) + 10
CCP <- expand.grid(s=s.val, x.t=seq(0, x_m), prob.replace=.5)
theta <- c(10,1)
pi_s = .25
group_by(CCP, s) %>%
mutate(
CCP.replace = first(prob.replace, order_by=x.t),
CCP.dont.replace = lead(prob.replace, default=last(prob.replace), order_by=x.t),
f = theta[1]*s-theta[2]*x.t+beta*(log(CCP.replace)-log(CCP.dont.replace)),
#for precision, calculate and store CCP and 1-CCP seperatly
prob.replace = 1/(1+exp(f)),
prob.dont.replace = exp(f)/(1+exp(f))
)
install.packages("dplyr")
